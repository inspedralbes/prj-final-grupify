# Regla para bloquear ataques SQL Injection comunes
SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|REQUEST_HEADERS|REQUEST_HEADERS_NAMES|REQUEST_METHOD|ARGS|ARGS_NAMES|XML:/* "@rx (?i:(?:select.*from|insert.*into|update.*set|delete.*from|drop.*table|union.*select))" \
    "id:1000,\
    phase:2,\
    block,\
    log,\
    msg:'Posible ataque de SQL Injection detectado',\
    severity:'CRITICAL'"

# Regla para bloquear ataques XSS comunes
SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|REQUEST_HEADERS|REQUEST_HEADERS_NAMES|REQUEST_METHOD|ARGS|ARGS_NAMES|XML:/* "@rx (?i:<script.*>|<.*onmouseover|<.*onerror|<.*onclick|javascript:)" \
    "id:1001,\
    phase:2,\
    block,\
    log,\
    msg:'Posible ataque XSS detectado',\
    severity:'CRITICAL'"

# Regla para limitar la tasa de solicitudes (rate limiting)
SecRule REMOTE_ADDR "@ipMatchFromFile /etc/modsecurity.d/custom-rules/blacklist.txt" \
    "id:1002,\
    phase:1,\
    deny,\
    log,\
    msg:'IP en lista negra detectada',\
    severity:'CRITICAL'"
